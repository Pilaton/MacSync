name: ğŸ§ª Tests

on:
  push:
    branches: [main]
    paths:
      - "bin/**"
      - "lib/**"
      - "test/**"
      - "config/**"
      - ".github/workflows/tests.yml"
  pull_request:
    branches: [main]
    paths:
      - "bin/**"
      - "lib/**"
      - "test/**"
      - "config/**"
      - ".github/workflows/tests.yml"

jobs:
  bats:
    name: BATS Tests
    runs-on: macos-latest
    timeout-minutes: 10
    steps:
      - name: â¬‡ï¸ Checkout
        uses: actions/checkout@v4

      - name: ğŸ“¦ Cache Homebrew
        uses: actions/cache@v4
        with:
          path: |
            ~/Library/Caches/Homebrew
            /opt/homebrew/Cellar/bats-core
          key: ${{ runner.os }}-brew-bats-${{ hashFiles('.github/workflows/tests.yml') }}
          restore-keys: |
            ${{ runner.os }}-brew-bats-

      - name: ğŸº Install BATS
        run: brew install bats-core

      - name: ğŸ§ª Run tests
        run: bats test/macsync.bats

      - name: âœ… Summary
        if: success()
        run: echo "All tests passed!"
